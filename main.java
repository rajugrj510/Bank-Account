main changes to the code.
